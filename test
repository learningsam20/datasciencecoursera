##
## This is a function for assignment for data cleansing course
##
## library(Data.table)
## library(LaF)
library(sqldf)
##
coln <- read.csv("D:\\Coding\\R\\Data cleansing\\UCI HAR Dataset\\features.txt",sep=" ",header=FALSE)
actn <- read.csv("D:\\Coding\\R\\Data cleansing\\UCI HAR Dataset\\activity_labels.txt",sep=" ",header=FALSE)
##
seqtestx <- c(seq(17,8977,by=16))
sqltestx <- "select "
for(i in 1:length(seqtestx))
{
 sqltestx <- paste(sqltestx, "substr(V1,",((i-1)*16+1),",16),")
}
sqltestx <- substring(sqltestx,1,nchar(sqltestx)-1)
sqltestx <- paste(sqltestx, " from filetestx")
filetestx <- file("D:\\Coding\\R\\Data cleansing\\UCI HAR Dataset\\test\\X_test.txt")
ftestx <- sqldf(sqltestx)
## colnames(ftestx) <- paste("V",1:561,sep="")
colnames(ftestx) <- as.character(coln$V2)
testy <- read.fwf("D:\\Coding\\R\\Data cleansing\\UCI HAR Dataset\\test\\y_test.txt",widths=(2),header=FALSE)
testyname <- merge(testy,actn,by="V1")
ftestx$testactivity <- testyname$V2
ftestx$subject <- read.fwf("D:\\Coding\\R\\Data cleansing\\UCI HAR Dataset\\test\\subject_test.txt",widths=(2),header=FALSE)
##
seqtrainx <- c(seq(17,8977,by=16))
sqltrainx <- "select "
for(i in 1:length(seqtrainx))
{
 sqltrainx <- paste(sqltrainx, "substr(V1,",((i-1)*16+1),",16),")
}
sqltrainx <- substring(sqltrainx,1,nchar(sqltrainx)-1)
sqltrainx <- paste(sqltrainx, " from filetrainx")
filetrainx <- file("D:\\Coding\\R\\Data cleansing\\UCI HAR Dataset\\train\\X_train.txt")
ftrainx <- sqldf(sqltrainx)
## colnames(ftrainx) <- paste("V",1:561,sep="")
colnames(ftrainx) <- as.character(coln$V2)
trainy <- read.fwf("D:\\Coding\\R\\Data cleansing\\UCI HAR Dataset\\train\\y_train.txt",widths=(2),header=FALSE)
trainyname <- merge(trainy,actn,by="V1")
ftrainx$trainactivity <- trainyname$V2
ftrainx$subject <- read.fwf("D:\\Coding\\R\\Data cleansing\\UCI HAR Dataset\\train\\subject_train.txt",widths=(2),header=FALSE)
##




## ftestx <- fread("D:\\Coding\\R\\Data cleansing\\UCI HAR Dataset\\test\\X_test.txt",sep=" ",header=FALSE)
## stestx <- read.table("D:\\Coding\\R\\Data cleansing\\UCI HAR Dataset\\test\\X_test.txt",header=FALSE,sep=" ",nrows=1)
## stestx <- read.fwf("D:\\Coding\\R\\Data cleansing\\UCI HAR Dataset\\test\\X_test.txt",sep=" ",header=FALSE,nrows=1,widths=seqtestx)
## ctestx <- sapply(stestx,class)
## ftestx <- read.table("D:\\Coding\\R\\Data cleansing\\UCI HAR Dataset\\test\\X_test.txt",header=FALSE,sep=" ",colClasses=ctestx)
## ftestx <- laf_open_fwf("D:\\Coding\\R\\Data cleansing\\UCI HAR Dataset\\test\\X_test.txt",column_widths=seqtestx,header=FALSE)
## ftesty <- read.fwf("D:\\Coding\\R\\Data cleansing\\UCI HAR Dataset\\test\\y_test.txt",sep=" ",header=FALSE)
## ftestsubject <- read.fwf("D:\\Coding\\R\\Data cleansing\\UCI HAR Dataset\\test\\subject_test.txt",sep=" ",header=FALSE)
## dtest <- as.data.frame(ftestx)
## dtest$y <- ftesty
## dtest$subject <- ftestsubject
